# نمایش مسیر مامور قرائت

این برنامه به شما امکان می‌دهد فایل اکسل حاوی اطلاعات مامورین قرائت را آپلود کرده و مسیر حرکت آن‌ها را بر اساس تاریخ و نام مامور روی نقشه مشاهده کنید.

## امکانات

- دریافت فایل اکسل (XLSX)
- امکان دانلود نمونه فایل اکسل
- استخراج خودکار تاریخ‌ها و نام مامورین
- فیلتر کردن داده‌ها بر اساس تاریخ و نام مامور
- مرتب‌سازی نقاط بر اساس ساعت قرائت
- نمایش مسیر حرکت مامور روی نقشه با خطوط متصل
- نمایش نقطه شروع با رنگ سبز، نقاط میانی با رنگ آبی و نقطه پایان با رنگ قرمز
- امکان نمایش انیمیشن حرکت مامور بین نقاط
- امکان صدور خروجی داده‌ها به فرمت CSV
- نمایش آمار فایل بارگذاری شده و تعداد رکوردهای معتبر

## نحوه استفاده

1. فایل `index.html` را در مرورگر خود باز کنید
2. اگر نمونه فایل اکسل می‌خواهید، روی لینک "دانلود نمونه فایل اکسل" کلیک کنید
3. روی دکمه "انتخاب فایل" کلیک کنید و فایل اکسل خود را انتخاب نمایید
4. روی دکمه "بارگذاری فایل" کلیک کنید تا فایل پردازش شود
5. اطلاعات آماری فایل نمایش داده می‌شود
6. از منوی کشویی، تاریخ مورد نظر را انتخاب کنید
7. از منوی کشویی، نام مامور مورد نظر را انتخاب کنید
8. روی دکمه "نمایش نقشه" کلیک کنید
9. مسیر حرکت مامور روی نقشه نمایش داده می‌شود
10. برای مشاهده انیمیشن مسیر، روی دکمه "نمایش انیمیشن مسیر" کلیک کنید
11. برای بازگشت به حالت اولیه، روی دکمه "بازنشانی" کلیک کنید
12. برای دریافت خروجی CSV، روی دکمه "دریافت خروجی" کلیک کنید

## ساختار فایل اکسل مورد نیاز

فایل اکسل باید دارای ساختار زیر باشد:
- داده‌ها از ردیف 4 شروع می‌شوند (سه ردیف اول عنوان یا توضیحات هستند)
- ستون C: نام مامور قرائت
- ستون D: نام انشعاب
- ستون E: تاریخ ثبت (به فرمت فارسی مانند ۱۴۰۴/۰۱/۰۳)
- ستون F: ساعت قرائت (به فرمت 09:04:00)
- ستون Q: موقعیت جغرافیایی (به فرمت 27.6411812,52.4600372)

## ویژگی‌های اضافه شده

- **نمایش انیمیشن مسیر**: می‌توانید مسیر حرکت مامور را به صورت انیمیشن و گام به گام مشاهده کنید
- **دانلود نمونه فایل اکسل**: امکان دانلود یک نمونه فایل با ساختار صحیح برای کمک به کاربران
- **تولید خروجی CSV**: امکان دریافت داده‌های فیلتر شده در قالب یک فایل CSV
- **نمایش آمار فایل**: نمایش اطلاعات آماری از فایل بارگذاری شده، شامل تعداد رکوردها، مامورین و تاریخ‌ها

## فناوری‌های استفاده شده

- HTML, CSS, JavaScript
- Leaflet.js برای نمایش نقشه
- SheetJS (XLSX) برای پردازش فایل اکسل

## نکات

- این برنامه به صورت کاملاً سمت کاربر (client-side) اجرا می‌شود و نیازی به سرور ندارد
- برای عملکرد بهتر، از مرورگرهای بروز مانند Chrome، Firefox یا Edge استفاده کنید
- برای مشاهده اطلاعات بیشتر هر نقطه، روی آن کلیک کنید
- اگر فایل شما دارای اشکال است، گزارش خطا و تعداد رکوردهای نامعتبر نمایش داده می‌شود # map-weather
